<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>
</head>
<body>
	<h1>114306018_HW7_1A2B</h1>
	
	<input type="text" id="guessInput" placeholder="Enter 4 unique numbers">
	<div class = "button-container">
			<input type = "button"  value = "Guess!" onClick = "play()">	
	</div>
	<div id="gameRecord">
		Game Record:
		<ul id="recordList"></ul>
	</div>		
	<script>
		var answer = [];
		var attempts = 0;

		window.onload = function() {
            generateAnswer();
        };

		
		function generateAnswer(){
			var numPool = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
			while(answer.length < 4){
				var index = Math.floor(Math.random() * numPool.length);
				answer.push(numPool[index]);
				numPool.splice(index, 1);
			}

		}

		function play(){

			var inputField = document.getElementById("guessInput");
			var userVal = inputField.value;

			if(!isValid(userVal)){
				 inputField.value = "";
				 return;
			}

			attempts ++;

			var result = checkAB(userVal, answer);

			var list = document.getElementById("recordList");
            var newItem = document.createElement("li");
            newItem.textContent = "第" + attempts + "次: " +  userVal + "⭢"  + result;
            list.appendChild(newItem);

            if (result === "4A0B") {
                alert("恭喜答對！總共猜了" + attempts + "次"); 
            }

            inputField.value = ""; 

		}

		function isValid(str){
			let uniqueCheck = new Set(str);
			if(str.length == 4 && !isNaN(str)){
				if(uniqueCheck.size == 4){
					return true;
				}
				else{
					alert("Check if there are any duplicate digits.")
					return false;
				}
			}
			else{
				alert("Check if the input consists of exactly 4 digits.")
				return false;
			}

		}

		function checkAB(userGuess, ans){
			var a=0;
			var b=0;

			for (var i = 0; i < 4; i++) {
                var guessDigit = parseInt(userGuess[i]);
                if (guessDigit === ans[i]) {
                    a++;
                } 
                else if (ans.includes(guessDigit)) {
                    b++;
                }
            }
            return a + "A" + b + "B";
		}
	</script>	
</body>
</html>